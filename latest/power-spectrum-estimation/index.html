<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Power Spectrum Estimation · BPJSpec</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../index.html"><img class="logo" src="../assets/logo.png" alt="BPJSpec logo"/></a><h1>BPJSpec</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../noise-model/">Noise Model</a></li><li><a class="toctext" href="../foreground-filtering/">Foreground Filtering</a></li><li><a class="toctext" href="../imaging/">Imaging</a></li><li class="current"><a class="toctext" href>Power Spectrum Estimation</a><ul class="internal"><li><a class="toctext" href="#API-1">API</a></li></ul></li><li><a class="toctext" href="../enormous-matrices/">Enormous Matrices</a></li><li><a class="toctext" href="../wrappers/">Wrappers</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Power Spectrum Estimation</a></li></ul><a class="edit-page" href="https://github.com/mweastwood/BPJSpec.jl/blob/master/docs/src/power-spectrum-estimation.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Power Spectrum Estimation</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Power-Spectrum-Estimation-1" href="#Power-Spectrum-Estimation-1">Power Spectrum Estimation</a></h1><h2><a class="nav-anchor" id="API-1" href="#API-1">API</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BPJSpec.q_estimator" href="#BPJSpec.q_estimator"><code>BPJSpec.q_estimator</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">q_estimator(mmodes, transfermatrix, covariancematrix, basis)</code></pre><p>Evaluate the <span>$q$</span> estimator:</p><div>\[q_a = v^* C^{-1} B C_a B^* C^{-1} v\]</div><p><strong>Arguments:</strong></p><ul><li><p><code>mmodes</code> or <span>$v$</span> specifies the list of measured <span>$m$</span>-modes</p></li><li><p><code>transfermatrix</code> or <span>$B$</span> specifies the interferometer&#39;s response to the sky</p></li><li><p><code>covariancematrix</code> or <span>$C$</span> specifies the covariance of the measured <span>$m$</span>-modes</p></li><li><p><code>basis</code> or <span>$C_a$</span> is a list of angular covariance matrices that represent the change in the covariance with respect to an increase in power of each 21-cm power spectrum bin</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/mweastwood/BPJSpec.jl/blob/e3b328b686795eb5be6bd6e3be192ff200f21db5/src/quadratic-estimator/q-estimator.jl#L16">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BPJSpec.fisher_information" href="#BPJSpec.fisher_information"><code>BPJSpec.fisher_information</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">fisher_information(transfermatrix, covariancematrix, basis; iterations=10)</code></pre><p>Compute a Monte-Carlo approximation of the Fisher information matrix.</p><div>\[F_{ab} = {\rm tr}\left( C^{-1} C_a C^{-1} C_b \right)\]</div><p><strong>Arguments:</strong></p><ul><li><p><code>transfermatrix</code> or <span>$B$</span> specifies the interferometer&#39;s response to the sky</p></li><li><p><code>covariancematrix</code> or <span>$C$</span> specifies the covariance of the measured <span>$m$</span>-modes</p></li><li><p><code>basis</code> or <span>$C_a$</span> is a list of angular covariance matrices that represent the change in the covariance with respect to an increase in power of each 21-cm power spectrum bin</p></li></ul><p><strong>Keyword Arguments:</strong></p><ul><li><p><code>iterations</code> is the number of Monte Carlo simulations to perform</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/mweastwood/BPJSpec.jl/blob/e3b328b686795eb5be6bd6e3be192ff200f21db5/src/quadratic-estimator/fisher-information.jl#L16">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BPJSpec.noise_bias" href="#BPJSpec.noise_bias"><code>BPJSpec.noise_bias</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">noise_bias(transfermatrix, covariancematrix, basis; iterations=10)</code></pre><p>Compute a Monte-Carlo approximation of the noise bias to the quadratic estimator.</p></div><a class="source-link" target="_blank" href="https://github.com/mweastwood/BPJSpec.jl/blob/e3b328b686795eb5be6bd6e3be192ff200f21db5/src/quadratic-estimator/fisher-information.jl#L41-L45">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BPJSpec.full_rank_compress!" href="#BPJSpec.full_rank_compress!"><code>BPJSpec.full_rank_compress!</code></a> — <span class="docstring-category">Function</span>.</div><div><pre><code class="language-none">full_rank_compress!(output_mmodes, output_transfermatrix, output_noisematrix,
                    input_mmodes,  input_transfermatrix,  input_noisematrix;
                    progress=false)</code></pre><p>In the case where the interferometer has more baselines than there are spherical harmonic coefficients to measure, the transfer matrix is tall and skinny. This also indicates that we have made redundant measurements that can be averaged together with no information loss.</p><p>In this routine we use the singular value decomposition (SVD) of the transfer matrix to compress the measurements. However, the SVD is just as large as the transfer matrix itself, and will take a lot of disk space to store. Therefore we will compute the SVD, compress everything with it all at once so that there is no need to store the SVD as well.</p><p><strong>Arguments:</strong></p><ul><li><p><code>output_mmodes</code> the output compressed <span>$m$</span>-modes</p></li><li><p><code>output_transfermatrix</code> the output compressed transfer matrix</p></li><li><p><code>output_noisematrix</code> the output compressed noise covariance matrix</p></li><li><p><code>input_mmodes</code> the input <span>$m$</span>-modes that will be compressed</p></li><li><p><code>input_transfermatrix</code> the input transfer matrix that will be used to generate the compression</p></li><li><p><code>input_noisematrix</code> the input noise covariance matrix</p></li></ul><p><strong>Keyword Arguments:</strong></p><ul><li><p><code>progress</code> if set to <code>true</code>, a progress bar will be displayed</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/mweastwood/BPJSpec.jl/blob/e3b328b686795eb5be6bd6e3be192ff200f21db5/src/algorithms/full-rank-compress.jl#L16">source</a></section><footer><hr/><a class="previous" href="../imaging/"><span class="direction">Previous</span><span class="title">Imaging</span></a><a class="next" href="../enormous-matrices/"><span class="direction">Next</span><span class="title">Enormous Matrices</span></a></footer></article></body></html>
